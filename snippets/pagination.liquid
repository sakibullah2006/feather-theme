{%- doc -%}
  @description
  Renders a set of links for paginated results with AJAX hydration support.
    Must be used within paginate tags. Uses the global hydrator store for seamless updates.

  @param {paginate} paginate - The paginate object.
  @param {string} [anchor] - This can be added so that on page reload it takes you to wherever you've placed your anchor tag.
  @param {string} [section_id] - The section ID to refresh. Defaults to section.id.
  @param {string[]} [slots] - Array of element IDs to update. Required for AJAX functionality.
  @param {string} [scroll_target] - Element ID to scroll to after content loads. Defaults to 'ProductGridContainer'.

  @example
  {% paginate results by 2 %}
    {% render 'pagination', 
      paginate: paginate, 
      section_id: section.id,
      slots: 'ProductGridContainer,CollectionProductCount',
      scroll_target: 'ProductGridContainer'
    %}
  {% endpaginate %}
{%- enddoc -%}

{%- liquid
  assign section_id = section_id | default: section.id
  assign slots_array = slots | split: ','
  assign scroll_target = scroll_target | default: 'ProductGridContainer'
-%}

{%- if paginate.parts.size > 0 -%}
  <div
    class="flex justify-center items-center my-12"
    role="navigation"
    aria-label="{{ 'general.pagination.label' | t }}"
    {%- if slots -%}
      x-data='
        {
          navigate(url) {
            if (this.$store && this.$store.hydrator) {
              const target = document.getElementById("{{ scroll_target }}");
                if (target) { target.scrollIntoView({ behavior: "smooth", block: "start" }); }
              this.$store.hydrator.fetch(url, "{{ section_id }}", {{ slots_array | json }})
            } else { window.location.href = url; }
          }
        }
      '
    {%- endif -%}
  >
    <nav class="flex items-center gap-3">
      {%- if paginate.previous -%}
        <a
          href="{{ paginate.previous.url }}{{ anchor }}"
          {%- if slots -%}
            @click.prevent="navigate('{{ paginate.previous.url }}')"
          {%- endif -%}
          class="inline-flex items-center justify-center size-10 border border-gray-200 text-gray-500 hover:border-black hover:text-black transition-colors"
          aria-label="{{ 'general.pagination.previous' | t }}"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" class="w-5 h-5 rotate-180">
            <path style="fill:currentColor" d="m17.5 5.999-.707.707 5.293 5.293H1v1h21.086l-5.294 5.295.707.707L24 12.499l-6.5-6.5z" data-name="Right"/>
          </svg>
        </a>
      {%- else -%}
        <span class="inline-flex items-center justify-center size-10 border border-gray-100 text-gray-200 cursor-not-allowed">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" class="w-5 h-5 rotate-180">
            <path style="fill:currentColor" d="m17.5 5.999-.707.707 5.293 5.293H1v1h21.086l-5.294 5.295.707.707L24 12.499l-6.5-6.5z" data-name="Right"/>
          </svg>
        </span>
      {%- endif -%}

      {%- for part in paginate.parts -%}
        {%- if part.is_link -%}
          <a
            href="{{ part.url }}{{ anchor }}"
            {%- if slots -%}
              @click.prevent="navigate('{{ part.url }}')"
            {%- endif -%}
            class="inline-flex items-center justify-center size-10 border border-gray-200 text-sm font-medium text-gray-400 hover:border-black hover:text-black transition-colors"
            aria-label="{{ 'general.pagination.page' | t: number: part.title }}"
          >
            {{- part.title -}}
          </a>
        {%- else -%}
          {%- if part.title == paginate.current_page -%}
            <span
              class="inline-flex items-center justify-center size-10 border border-black bg-[#1a1a1a] text-white text-sm font-bold"
              aria-current="page"
              aria-label="{{ 'general.pagination.page' | t: number: part.title }}"
            >
              {{- part.title -}}
            </span>
          {%- else -%}
            <span class="inline-flex items-center justify-center w-10 h-12 text-gray-300 tracking-widest">
              {{- part.title -}}
            </span>
          {%- endif -%}
        {%- endif -%}
      {%- endfor -%}

      {%- if paginate.next -%}
        <a
          href="{{ paginate.next.url }}{{ anchor }}"
          {%- if slots -%}
            @click.prevent="navigate('{{ paginate.next.url }}')"
          {%- endif -%}
          class="inline-flex items-center justify-center size-10 border border-gray-200 text-gray-500 hover:border-black hover:text-black transition-colors"
          aria-label="{{ 'general.pagination.next' | t }}"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" class="w-5 h-5">
            <path style="fill:currentColor" d="m17.5 5.999-.707.707 5.293 5.293H1v1h21.086l-5.294 5.295.707.707L24 12.499l-6.5-6.5z" data-name="Right"/>
          </svg>
        </a>
      {%- else -%}
        <span class="inline-flex items-center justify-center size-10 border border-gray-100 text-gray-200 cursor-not-allowed">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" class="w-5 h-5">
            <path style="fill:currentColor" d="m17.5 5.999-.707.707 5.293 5.293H1v1h21.086l-5.294 5.295.707.707L24 12.499l-6.5-6.5z" data-name="Right"/>
          </svg>
        </span>
      {%- endif -%}
    </nav>
  </div>
{%- endif -%}
